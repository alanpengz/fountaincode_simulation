# UVLC_image_serial
# 基于跨层不平等保护传输策略的光通信动态中继（对图像数据）
## 应用层：基于小波变换的SPIHT渐进压缩编码、扩展窗喷泉码（应用层不平等保护）。
## 传输层：重要数据包的准确传输（传输层不平等保护，采用类TCP的校验和、确认应当、检错重发），图像数据的喷泉码类UDP传输。

- 调用pywt库对图像rgb三个矩阵进行小波变换，再调用matlab库里的spiht算法对小波矩阵进行渐进压缩编码，得到三个二进制比特流数据，存入三个文件（方便查看调试）。
- 喷泉码lib库，包括喷泉码的编码类和解码类：
    - 编码类里主要有用随机数种子和鲁棒孤波分布选择代码块进行异或，得到一个异或后的数据块，将数据块转成drop类（包括数据、种子、总的分块数、将种子和块数bit转换为byte加上数据进行传输）；
    - 解码类将收到的字节数据解析为drop类，存入一个列表，每来到一个drop，看是否有度值为1的drop，并进行递归bp译码，直到译出所需要的全部数据块停止。
- 串口的发送类sender：调用上面两个lib里的类，将渐进编码后的bit流数据分块，并转换成byte。调用编码类对选中的码块进行字节异或，发送。
- 接收类receiver：不断接收数据，调用解码类的方法，设置接收停止条件。再把收到的字节数据转bit流解析回原来的编码后的bit流，进行spiht的译码。

- 加入探测序列，根据探测序列的返回确定发送端的编码方案（喷泉码 or RS），喷泉码的译码时间和分块数、发送间隔、硬件处理能力有关。
- 对于重要数据包的可靠传输逻辑(待加)：
  - 发送端发送一次之后，启动重发线程，线程检测输入缓存中是否有ack1，线程不断发送重要数据包直到检测到ack1。收到ack1之后，停止发送任何信息10s。再喷泉码发送剩余数据。
  - 接收端循环接收，如果收到正确的一个包，跳出循环。一直发送ack1，当检测到接受区一段时间内没有收到信息后跳出。进行喷泉码的接收。
